kind: ConfigMap
apiVersion: v1
metadata:
  name: per-cluster
  namespace: open-cluster-management-observability
  annotations:
    observability.open-cluster-management.io/dashboard-folder: NetObserv
  labels:
    grafana-custom-dashboard: "true"
data:
  per-cluster.json: |
    {"annotations": {"list": [{"builtIn": 1, "datasource": "-- Grafana --", "enable": true, "hide": true, "iconColor": "rgba(0, 211, 255, 1)", "name": "Annotations & Alerts", "target": {"limit": 100, "matchAny": false, "tags": [], "type": "dashboard"}, "type": "dashboard"}]}, "editable": true, "gnetId": null, "graphTooltip": 0, "id": 35, "iteration": 1700039615978, "links": [{"asDropdown": false, "icon": "dashboard", "includeVars": false, "keepTime": true, "tags": [], "targetBlank": false, "title": "Back to Overview", "tooltip": "", "type": "link", "url": "/d/b3f0cffc770eaed49b83093e218d0046/clusters-overview"}], "panels": [{"collapsed": false, "datasource": null, "gridPos": {"h": 1, "w": 24, "x": 0, "y": 0}, "id": 42, "panels": [], "title": "Ingress", "type": "row"}, {"cacheTimeout": null, "datasource": "$datasource", "description": "", "fieldConfig": {"defaults": {"color": {"fixedColor": "rgb(255, 255, 255)", "mode": "fixed"}, "mappings": [{"options": {"match": "null", "result": {"text": "N/A"}}, "type": "special"}], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]}, "unit": "Bps"}, "overrides": []}, "gridPos": {"h": 6, "w": 3, "x": 0, "y": 1}, "id": 6, "interval": null, "links": [], "maxDataPoints": 100, "options": {"colorMode": "value", "graphMode": "none", "justifyMode": "auto", "orientation": "horizontal", "reduceOptions": {"calcs": [], "fields": "", "values": false}, "text": {}, "textMode": "auto"}, "pluginVersion": "8.5.20", "targets": [{"exemplar": true, "expr": "sum(namespace:netobserv_workload_ingress_bytes_total:dst:rate5m{cluster=\"$cluster\",namespace!=\"\"})", "format": "time_series", "hide": false, "instant": true, "interval": "", "intervalFactor": 1, "legendFormat": "All incoming", "refId": "B"}, {"exemplar": true, "expr": "sum(namespace:netobserv_workload_ingress_bytes_total:dst:unknown_src:rate5m{cluster=\"$cluster\",namespace!=\"\"})", "format": "time_series", "instant": true, "interval": "", "intervalFactor": 1, "legendFormat": "Cluster incoming", "refId": "A"}], "timeFrom": null, "timeShift": null, "title": "Byte Rate", "type": "stat"}, {"aliasColors": {}, "bars": false, "dashLength": 10, "dashes": false, "datasource": "$datasource", "fieldConfig": {"defaults": {"links": [], "unit": "Bps"}, "overrides": []}, "fill": 8, "fillGradient": 5, "gridPos": {"h": 12, "w": 11, "x": 3, "y": 1}, "hiddenSeries": false, "id": 16, "interval": "", "legend": {"alignAsTable": false, "avg": false, "current": false, "max": false, "min": false, "rightSide": false, "show": true, "sideWidth": 250, "total": false, "values": false}, "lines": true, "linewidth": 2, "nullPointMode": "null as zero", "options": {"alertThreshold": true}, "percentage": false, "pluginVersion": "8.5.20", "pointradius": 2, "points": false, "renderer": "flot", "seriesOverrides": [], "spaceLength": 10, "stack": true, "steppedLine": false, "targets": [{"exemplar": true, "expr": "topk(10,namespace:netobserv_workload_ingress_bytes_total:dst:rate5m{cluster=\"$cluster\",namespace!=\"\"})", "interval": "", "legendFormat": "{{namespace}} ", "refId": "A"}], "thresholds": [], "timeFrom": null, "timeRegions": [], "timeShift": null, "title": "Top 10 namespaces - All incoming traffic", "tooltip": {"shared": true, "sort": 0, "value_type": "individual"}, "type": "graph", "xaxis": {"buckets": null, "mode": "time", "name": null, "show": true, "values": []}, "yaxes": [{"$$hashKey": "object:442", "format": "Bps", "label": null, "logBase": 1, "max": null, "min": null, "show": true}, {"$$hashKey": "object:443", "format": "short", "label": null, "logBase": 1, "max": null, "min": null, "show": true}], "yaxis": {"align": false, "alignLevel": null}}, {"aliasColors": {}, "bars": false, "dashLength": 10, "dashes": false, "datasource": "$datasource", "fieldConfig": {"defaults": {"links": [], "unit": "Bps"}, "overrides": []}, "fill": 8, "fillGradient": 5, "gridPos": {"h": 12, "w": 10, "x": 14, "y": 1}, "hiddenSeries": false, "id": 43, "interval": "", "legend": {"alignAsTable": false, "avg": false, "current": false, "max": false, "min": false, "rightSide": false, "show": true, "sideWidth": 250, "total": false, "values": false}, "lines": true, "linewidth": 2, "nullPointMode": "null as zero", "options": {"alertThreshold": true}, "percentage": false, "pluginVersion": "8.5.20", "pointradius": 2, "points": false, "renderer": "flot", "seriesOverrides": [], "spaceLength": 10, "stack": true, "steppedLine": false, "targets": [{"exemplar": true, "expr": "topk(10,namespace:netobserv_workload_ingress_bytes_total:dst:unknown_src:rate5m{cluster=\"$cluster\",namespace!=\"\"})", "interval": "", "legendFormat": "{{namespace}} ", "refId": "A"}], "thresholds": [], "timeFrom": null, "timeRegions": [], "timeShift": null, "title": "Top 10 namespaces - Cluster-incoming traffic", "tooltip": {"shared": true, "sort": 0, "value_type": "individual"}, "type": "graph", "xaxis": {"buckets": null, "mode": "time", "name": null, "show": true, "values": []}, "yaxes": [{"$$hashKey": "object:442", "format": "Bps", "label": null, "logBase": 1, "max": null, "min": null, "show": true}, {"$$hashKey": "object:443", "format": "short", "label": null, "logBase": 1, "max": null, "min": null, "show": true}], "yaxis": {"align": false, "alignLevel": null}}, {"cacheTimeout": null, "datasource": "$datasource", "fieldConfig": {"defaults": {"color": {"fixedColor": "rgb(255, 255, 255)", "mode": "fixed"}, "mappings": [{"options": {"match": "null", "result": {"text": "N/A"}}, "type": "special"}], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]}, "unit": "pps"}, "overrides": []}, "gridPos": {"h": 6, "w": 3, "x": 0, "y": 7}, "id": 37, "interval": null, "links": [], "maxDataPoints": 100, "options": {"colorMode": "value", "graphMode": "none", "justifyMode": "auto", "orientation": "horizontal", "reduceOptions": {"calcs": [], "fields": "", "values": false}, "text": {}, "textMode": "auto"}, "pluginVersion": "8.5.20", "targets": [{"exemplar": true, "expr": "sum(namespace:netobserv_workload_ingress_packets_total:dst:rate5m{cluster=\"$cluster\",namespace!=\"\"})", "format": "time_series", "instant": true, "interval": "", "intervalFactor": 1, "legendFormat": "All incoming", "refId": "A"}, {"exemplar": true, "expr": "sum(namespace:netobserv_workload_ingress_packets_total:dst:unknown_src:rate5m{cluster=\"$cluster\",namespace!=\"\"})", "format": "time_series", "hide": false, "instant": true, "interval": "", "intervalFactor": 1, "legendFormat": "Cluster incoming", "refId": "B"}], "timeFrom": null, "timeShift": null, "title": "Packet Rate", "type": "stat"}, {"collapsed": false, "datasource": null, "gridPos": {"h": 1, "w": 24, "x": 0, "y": 13}, "id": 45, "panels": [], "title": "Egress", "type": "row"}, {"cacheTimeout": null, "datasource": "$datasource", "description": "", "fieldConfig": {"defaults": {"color": {"fixedColor": "rgb(255, 255, 255)", "mode": "fixed"}, "mappings": [{"options": {"match": "null", "result": {"text": "N/A"}}, "type": "special"}], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]}, "unit": "Bps"}, "overrides": []}, "gridPos": {"h": 6, "w": 3, "x": 0, "y": 14}, "id": 46, "interval": null, "links": [], "maxDataPoints": 100, "options": {"colorMode": "value", "graphMode": "none", "justifyMode": "auto", "orientation": "horizontal", "reduceOptions": {"calcs": [], "fields": "", "values": false}, "text": {}, "textMode": "auto"}, "pluginVersion": "8.5.20", "targets": [{"exemplar": true, "expr": "sum(namespace:netobserv_workload_egress_bytes_total:src:rate5m{cluster=\"$cluster\",namespace!=\"\"})", "format": "time_series", "hide": false, "instant": true, "interval": "", "intervalFactor": 1, "legendFormat": "All outgoing", "refId": "B"}, {"exemplar": true, "expr": "sum(namespace:netobserv_workload_egress_bytes_total:src:unknown_dst:rate5m{cluster=\"$cluster\",namespace!=\"\"})", "format": "time_series", "instant": true, "interval": "", "intervalFactor": 1, "legendFormat": "Cluster outgoing", "refId": "A"}], "timeFrom": null, "timeShift": null, "title": "Byte Rate", "type": "stat"}, {"aliasColors": {}, "bars": false, "dashLength": 10, "dashes": false, "datasource": "$datasource", "fieldConfig": {"defaults": {"links": [], "unit": "Bps"}, "overrides": []}, "fill": 8, "fillGradient": 5, "gridPos": {"h": 12, "w": 11, "x": 3, "y": 14}, "hiddenSeries": false, "id": 48, "interval": "", "legend": {"alignAsTable": false, "avg": false, "current": false, "max": false, "min": false, "rightSide": false, "show": true, "sideWidth": 250, "total": false, "values": false}, "lines": true, "linewidth": 2, "nullPointMode": "null as zero", "options": {"alertThreshold": true}, "percentage": false, "pluginVersion": "8.5.20", "pointradius": 2, "points": false, "renderer": "flot", "seriesOverrides": [], "spaceLength": 10, "stack": true, "steppedLine": false, "targets": [{"exemplar": true, "expr": "topk(10,namespace:netobserv_workload_egress_bytes_total:src:rate5m{cluster=\"$cluster\",namespace!=\"\"})", "interval": "", "legendFormat": "{{namespace}} ", "refId": "A"}], "thresholds": [], "timeFrom": null, "timeRegions": [], "timeShift": null, "title": "Top 10 namespaces - All outgoing traffic", "tooltip": {"shared": true, "sort": 0, "value_type": "individual"}, "type": "graph", "xaxis": {"buckets": null, "mode": "time", "name": null, "show": true, "values": []}, "yaxes": [{"$$hashKey": "object:442", "format": "Bps", "label": null, "logBase": 1, "max": null, "min": null, "show": true}, {"$$hashKey": "object:443", "format": "short", "label": null, "logBase": 1, "max": null, "min": null, "show": true}], "yaxis": {"align": false, "alignLevel": null}}, {"aliasColors": {}, "bars": false, "dashLength": 10, "dashes": false, "datasource": "$datasource", "fieldConfig": {"defaults": {"links": [], "unit": "Bps"}, "overrides": []}, "fill": 8, "fillGradient": 5, "gridPos": {"h": 12, "w": 10, "x": 14, "y": 14}, "hiddenSeries": false, "id": 49, "interval": "", "legend": {"alignAsTable": false, "avg": false, "current": false, "max": false, "min": false, "rightSide": false, "show": true, "sideWidth": 250, "total": false, "values": false}, "lines": true, "linewidth": 2, "nullPointMode": "null as zero", "options": {"alertThreshold": true}, "percentage": false, "pluginVersion": "8.5.20", "pointradius": 2, "points": false, "renderer": "flot", "seriesOverrides": [], "spaceLength": 10, "stack": true, "steppedLine": false, "targets": [{"exemplar": true, "expr": "topk(10,namespace:netobserv_workload_egress_bytes_total:src:unknown_dst:rate5m{cluster=\"$cluster\",namespace!=\"\"})", "interval": "", "legendFormat": "{{namespace}} ", "refId": "A"}], "thresholds": [], "timeFrom": null, "timeRegions": [], "timeShift": null, "title": "Top 10 namespaces - Cluster-outgoing traffic", "tooltip": {"shared": true, "sort": 0, "value_type": "individual"}, "type": "graph", "xaxis": {"buckets": null, "mode": "time", "name": null, "show": true, "values": []}, "yaxes": [{"$$hashKey": "object:442", "format": "Bps", "label": null, "logBase": 1, "max": null, "min": null, "show": true}, {"$$hashKey": "object:443", "format": "short", "label": null, "logBase": 1, "max": null, "min": null, "show": true}], "yaxis": {"align": false, "alignLevel": null}}, {"cacheTimeout": null, "datasource": "$datasource", "fieldConfig": {"defaults": {"color": {"fixedColor": "rgb(255, 255, 255)", "mode": "fixed"}, "mappings": [{"options": {"match": "null", "result": {"text": "N/A"}}, "type": "special"}], "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]}, "unit": "pps"}, "overrides": []}, "gridPos": {"h": 6, "w": 3, "x": 0, "y": 20}, "id": 47, "interval": null, "links": [], "maxDataPoints": 100, "options": {"colorMode": "value", "graphMode": "none", "justifyMode": "auto", "orientation": "horizontal", "reduceOptions": {"calcs": [], "fields": "", "values": false}, "text": {}, "textMode": "auto"}, "pluginVersion": "8.5.20", "targets": [{"exemplar": true, "expr": "sum(namespace:netobserv_workload_egress_packets_total:src:rate5m{cluster=\"$cluster\",namespace!=\"\"})", "format": "time_series", "instant": true, "interval": "", "intervalFactor": 1, "legendFormat": "All outgoing", "refId": "A"}, {"exemplar": true, "expr": "sum(namespace:netobserv_workload_egress_packets_total:src:unknown_dst:rate5m{cluster=\"$cluster\",namespace!=\"\"})", "format": "time_series", "hide": false, "instant": true, "interval": "", "intervalFactor": 1, "legendFormat": "Cluster outgoing", "refId": "B"}], "timeFrom": null, "timeShift": null, "title": "Packet Rate", "type": "stat"}, {"collapsed": false, "datasource": "$datasource", "gridPos": {"h": 1, "w": 24, "x": 0, "y": 26}, "id": 2, "panels": [], "title": "Networking", "type": "row"}, {"datasource": "$datasource", "fieldConfig": {"defaults": {"color": {"mode": "thresholds"}, "custom": {"align": null, "displayMode": "auto", "filterable": false}, "mappings": [], "noValue": "-", "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]}}, "overrides": [{"matcher": {"id": "byName", "options": "Value #Z"}, "properties": [{"id": "links", "value": [{"targetBlank": false, "title": "Drill down to pods", "url": "/d/85a562078cdf77779eaa1add43ccec1e/k8s-resources-namespace?${__url_time_range}&var-datasource=$datasource&var-cluster=$cluster&var-namespace=${__data.fields.namespace}"}]}, {"id": "custom.align", "value": "left"}]}, {"matcher": {"id": "byRegexp", "options": "(in|out).*"}, "properties": [{"id": "unit", "value": "Bps"}]}, {"matcher": {"id": "byRegexp", "options": "%.*"}, "properties": [{"id": "unit", "value": "percentunit"}]}]}, "gridPos": {"h": 9, "w": 24, "x": 0, "y": 27}, "id": 26, "interval": "4m", "links": [], "options": {"showHeader": true, "sortBy": [{"desc": true, "displayName": "% in"}]}, "pluginVersion": "8.5.20", "targets": [{"exemplar": true, "expr": "sum(namespace:netobserv_workload_ingress_bytes_total:dst:rate5m{cluster=\"$cluster\"}) by (namespace) / ignoring (namespace) group_left sum(namespace:netobserv_workload_ingress_bytes_total:dst:rate5m{cluster=\"$cluster\"})", "format": "table", "hide": false, "instant": true, "interval": "", "legendFormat": "", "refId": "PCT_IN"}, {"exemplar": true, "expr": "sum(namespace:netobserv_workload_egress_bytes_total:src:rate5m{cluster=\"$cluster\"}) by (namespace) / ignoring (namespace) group_left sum(namespace:netobserv_workload_egress_bytes_total:src:rate5m{cluster=\"$cluster\"})", "format": "table", "hide": false, "instant": true, "interval": "", "legendFormat": "", "refId": "PCT_OUT"}, {"exemplar": true, "expr": "sum(namespace:netobserv_workload_ingress_bytes_total:dst:rate5m{cluster=\"$cluster\"}) by (namespace)", "format": "table", "instant": true, "interval": "", "intervalFactor": 1, "legendFormat": "", "refId": "IN", "step": 10}, {"exemplar": true, "expr": "sum(namespace:netobserv_workload_egress_bytes_total:src:rate5m{cluster=\"$cluster\"}) by (namespace)", "format": "table", "instant": true, "interval": "", "intervalFactor": 1, "legendFormat": "", "refId": "OUT", "step": 10}, {"exemplar": true, "expr": "sum(namespace:netobserv_workload_ingress_bytes_total:dst:unknown_src:rate5m{cluster=\"$cluster\"}) by (namespace)", "format": "table", "hide": false, "instant": true, "interval": "", "intervalFactor": 1, "legendFormat": "", "refId": "IN_EXT", "step": 10}, {"exemplar": true, "expr": "sum(namespace:netobserv_workload_egress_bytes_total:src:unknown_dst:rate5m{cluster=\"$cluster\"}) by (namespace)", "format": "table", "hide": false, "instant": true, "interval": "", "intervalFactor": 1, "legendFormat": "", "refId": "OUT_EXT", "step": 10}, {"exemplar": true, "expr": "sum(kube_pod_owner{cluster=\"$cluster\"}) by (namespace)", "format": "table", "hide": false, "instant": true, "interval": "", "legendFormat": "", "refId": "Z"}], "timeFrom": null, "timeShift": null, "title": "Namespaces", "transformations": [{"id": "filterFieldsByName", "options": {"include": {"names": ["namespace", "Value #PCT_IN", "Value #PCT_OUT", "Value #IN", "Value #OUT", "Value #Z", "Value #IN_EXT", "Value #OUT_EXT"]}}}, {"id": "merge", "options": {}}, {"id": "sortBy", "options": {"fields": {}, "sort": [{"desc": true, "field": "Value #PCT_IN"}]}}, {"id": "organize", "options": {"excludeByName": {}, "indexByName": {}, "renameByName": {"Value #IN": "in", "Value #IN_EXT": "in (external)", "Value #OUT": "out", "Value #OUT_EXT": "out (external)", "Value #PCT_IN": "% in", "Value #PCT_OUT": "% out", "Value #Z": "pods"}}}], "type": "table"}, {"datasource": "$datasource", "fieldConfig": {"defaults": {"color": {"mode": "thresholds"}, "custom": {"align": null, "displayMode": "auto", "filterable": false}, "mappings": [], "noValue": "-", "thresholds": {"mode": "absolute", "steps": [{"color": "green", "value": null}]}}, "overrides": [{"matcher": {"id": "byName", "options": "Value #C"}, "properties": [{"id": "displayName", "value": "% out"}, {"id": "unit", "value": "percentunit"}, {"id": "decimals", "value": 2}, {"id": "custom.align", "value": "left"}]}, {"matcher": {"id": "byName", "options": "Value #E"}, "properties": [{"id": "displayName", "value": "% in"}, {"id": "unit", "value": "percentunit"}, {"id": "decimals", "value": 2}, {"id": "custom.align", "value": "left"}]}, {"matcher": {"id": "byName", "options": "namespace"}, "properties": [{"id": "custom.width", "value": 317}]}]}, "gridPos": {"h": 9, "w": 24, "x": 0, "y": 36}, "id": 39, "interval": "4m", "links": [], "options": {"showHeader": true, "sortBy": []}, "pluginVersion": "8.5.20", "targets": [{"exemplar": true, "expr": "topk(10,sum(workload:netobserv_workload_ingress_bytes_total:dst:rate5m{cluster=\"$cluster\",kind!=\"Node\"}) by (workload,namespace,kind)) / ignoring(namespace,workload,kind) group_left sum(workload:netobserv_workload_ingress_bytes_total:dst:rate5m{cluster=\"$cluster\"})", "format": "table", "instant": true, "interval": "", "intervalFactor": 1, "legendFormat": "", "refId": "E", "step": 10}, {"exemplar": true, "expr": "topk(10,sum(workload:netobserv_workload_egress_bytes_total:src:rate5m{cluster=\"$cluster\",kind!=\"Node\"}) by (workload,namespace,kind)) / ignoring(namespace,workload,kind) group_left sum(workload:netobserv_workload_egress_bytes_total:src:rate5m{cluster=\"$cluster\"})", "format": "table", "instant": true, "interval": "", "intervalFactor": 1, "legendFormat": "", "refId": "C", "step": 10}], "timeFrom": null, "timeShift": null, "title": "Top Workloads", "transformations": [{"id": "filterFieldsByName", "options": {"include": {"names": ["workload", "namespace", "kind", "Value #E", "Value #C", "Value #B"]}}}, {"id": "merge", "options": {}}, {"id": "organize", "options": {"excludeByName": {}, "indexByName": {"Value #C": 4, "Value #E": 3, "kind": 1, "namespace": 2, "workload": 0}, "renameByName": {}}}], "type": "table"}], "refresh": "", "schemaVersion": 30, "style": "dark", "tags": [], "templating": {"list": [{"current": {"selected": false, "text": "Observatorium", "value": "Observatorium"}, "description": null, "error": null, "hide": 2, "includeAll": false, "label": null, "multi": false, "name": "datasource", "options": [], "query": "prometheus", "queryValue": "", "refresh": 2, "regex": "", "skipUrlSync": false, "type": "datasource"}, {"allValue": null, "current": {"selected": false, "text": "local-cluster", "value": "local-cluster"}, "datasource": "$datasource", "definition": "label_values(acm_managed_cluster_labels{openshiftVersion_major!=\"3\"},name)", "description": null, "error": null, "hide": 0, "includeAll": false, "label": "Cluster", "multi": false, "name": "cluster", "options": [], "query": {"query": "label_values(acm_managed_cluster_labels{openshiftVersion_major!=\"3\"},name)", "refId": "Observatorium-cluster-Variable-Query"}, "refresh": 2, "regex": "", "skipUrlSync": false, "sort": 1, "tagValuesQuery": "", "tagsQuery": "", "type": "query", "useTags": false}]}, "time": {"from": "now-1h", "to": "now"}, "timepicker": {"refresh_intervals": ["1m", "5m", "15m", "30m", "1h", "2h", "1d"]}, "timezone": "browser", "title": "Per Cluster", "version": 5}
